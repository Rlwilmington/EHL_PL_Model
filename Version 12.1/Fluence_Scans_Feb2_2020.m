

% power_vs_strain = [
%    -0.00009917364607037182, 0.7005617977528098;
%     0.49949994133389963, 0.8230337078651693
%     1.0001536493108125, 1.0971910112359557
%     1.4994468624810735, 1.4657303370786519
%     1.9989635655579705, 1.6544943820224722
%     2.4987666150777468, 1.612921348314607];

plot(power_vs_strain(:,1),power_vs_strain(:,2))

G_VB = [
   -0.0004965513972174929, 3.5551947097722265
    0.5009113318006211, 2.8865312507406795
    0.9992806522718114, 2.6034343817401817
    1.500353155886327, 2.308450854447631
    2.0000082956080685, 2.0926941764831364
    2.500981251925766, 1.9086262473039273];

plot(G_VB(:,1),G_VB(:,2))


%L -> A excitons (specifies spin)

K_VB_L = [
   -0.0013943112102621225, 0.6383244206773618
    0.5019520356943675, 0.6279857397504456
    1.0011154489682101, 0.6251336898395722
    1.5030674846625773, 0.6103386809269161
    2.000836586726158, 0.6073083778966132
    2.5041829336307866, 0.5964349376114082];

K_VB_U = [
   -0.0013943112102621225, 0.5707664884135472
    0.49916341327384284, 0.559536541889483
    0.9983268265476856, 0.548663101604278
    1.496095928611266, 0.5390374331550801
    1.9980479643056333, 0.5322638146167558
    2.5000000000000004, 0.5240641711229945];

K_CB_L = [
    1.1102230246251565e-16, 0.5098039215686274
    0.5005577244841052, 0.4850267379679144
    0.9997211377579479, 0.45900178253119417
    1.4988845510317903, 0.45811051693404625
    1.9994422755158956, 0.44652406417112295
    2.5, 0.43725490196078426];

K_CB_U = [
    0, 0.4841354723707664
    0.5005577244841052, 0.46577540106951865
    1.0011154489682101, 0.4513368983957219
    1.5002788622420526, 0.4351158645276292
    2.000836586726158, 0.4228163992869875
    2.501394311210263, 0.4140819964349376];

figure();
hold on
plot(K_VB_L(:,1),K_VB_L(:,2),'*-')
plot(K_VB_U(:,1),K_VB_U(:,2),'*-')
plot(K_CB_L(:,1),K_CB_L(:,2),'*-')
plot(K_CB_U(:,1),K_CB_U(:,2),'*-')
hold off

E_off = [
    564.453125, -0.05789473684210525
    818.359375, -0.050375939849624074
    1056.6406249999998, -0.054385964912280704
    1306.6406249999998, -0.051629072681704274
    1541.0156249999998, -0.04160401002506267
    1791.0156249999998, -0.013533834586466176
    2037.1093749999993, -0.010526315789473675
    2275.390624999999, -0.0027568922305764437
    2517.578125, 0.01177944862155389
    2763.671874999999, 0.026315789473684216
    3009.765624999999, 0.03834586466165414
    3251.953124999999, 0.03007518796992481
    3501.953124999999, 0.047368421052631574
    3736.328124999999, 0.047368421052631574
    3986.328124999999, 0.057393483709273184];

figure();
plot(E_off(:,1),E_off(:,2),'*')



%%

%area = 2 microns^2

%2 microns^2 = 2e-8 cm^2

%1 mW = 1e-6 kW

%1mW = 50kW/cm^2?



flu_strain_fun = @(fluence) interp1(power_vs_strain(:,1),power_vs_strain(:,2),fluence,'linear','extrap');




m_h_G_fun = @(strain) interp1(G_VB(:,1),G_VB(:,2),strain,'linear','extrap');
m_h_K_fun = @(strain) interp1(K_VB_L(:,1),K_VB_L(:,2),strain,'linear','extrap');
m_e_K_fun = @(strain) interp1(K_CB_L(:,1),K_CB_L(:,2),strain,'linear','extrap');


x = linspace(0,3,100);
y1 = m_h_K_fun(x);
y2 = m_h_G_fun(x);
y3 = m_e_K_fun(x);

figure();
hold on
plot(x,y1)
plot(x,y2)
plot(x,y3)
hold off

figure();
x2 = linspace(0,5000,100);
y4 = flu_strain_fun(x2);

plot(x2,y4,'x')


